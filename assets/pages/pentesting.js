function loadPentestingContent(contentArea) {
    const initialContent = `
      <div class="pentesting-container">
        <h1>Пентестинг</h1>
        <div class="pentesting-description">
          <p><strong>Пентестинг</strong> (проникновение, penetration testing) — это процесс имитации кибератак на систему, сеть или приложение с целью выявления уязвимостей, которые могут быть использованы злоумышленниками. Основная цель пентеста — оценить уровень безопасности, определить слабые места и предоставить рекомендации по их устранению до того, как они будут эксплуатированы реальными атакующими.</p>
          <p>Пентестинг проводится в соответствии с законодательством (например, ФЗ-152 "О персональных данных", ФЗ-187 "О безопасности КИИ" в России) и международными стандартами (OWASP, NIST SP 800-115, PTES). Он может быть направлен на веб-приложения, сети, мобильные приложения, IoT-устройства или физическую инфраструктуру.</p>
        </div>
  
        <div class="pentesting-description">
          <h2>Типы пентестинга</h2>
          <p>Пентестинг классифицируется по различным признакам:</p>
          <ul>
            <li><strong>По уровню доступа:</strong>
              <ul>
                <li><strong>Black Box:</strong> Тестирование без предварительной информации о системе (имитация внешнего хакера).</li>
                <li><strong>Gray Box:</strong> Частичная информация (например, учетные данные пользователя).</li>
                <li><strong>White Box:</strong> Полный доступ к архитектуре, коду и документации.</li>
              </ul>
            </li>
            <li><strong>По объекту:</strong>
              <ul>
                <li>Веб-приложения (OWASP Top 10: XSS, SQLi).</li>
                <li>Сети (уязвимости протоколов, слабые пароли).</li>
                <li>Мобильные приложения (Android, iOS).</li>
                <li>Физическая безопасность (доступ в офис, серверные).</li>
              </ul>
            </li>
            <li><strong>По подходу:</strong>
              <ul>
                <li>Внешний (атака из интернета).</li>
                <li>Внутренний (имитация инсайдера).</li>
              </ul>
            </li>
          </ul>
  
          <h2>Этапы пентестинга</h2>
          <p>Процесс пентестинга включает следующие шаги:</p>
          <ol>
            <li><strong>Планирование:</strong> Определение целей, объема, правил взаимодействия (RoE), подписание соглашений с заказчиком.</li>
            <li><strong>Разведка:</strong> Сбор информации о цели (пассивный — OSINT, активный — сканирование).</li>
            <li><strong>Анализ уязвимостей:</strong> Поиск слабых мест с помощью инструментов (Nessus, Burp Suite) и ручного анализа.</li>
            <li><strong>Эксплуатация:</strong> Попытка использовать уязвимости для получения доступа (Metasploit, эксплойты).</li>
            <li><strong>Пост-эксплуатация:</strong> Оценка глубины проникновения (эскалация привилегий, сбор данных).</li>
            <li><strong>Документирование:</strong> Составление отчета с описанием уязвимостей, последствий и рекомендаций.</li>
            <li><strong>Устранение:</strong> Помощь в исправлении выявленных проблем (опционально).</li>
            <li><strong>Повторное тестирование:</strong> Проверка устранения уязвимостей.</li>
          </ol>
  
          <h2>Инструменты пентестинга</h2>
          <ul>
            <li><strong>OSINT:</strong> Maltego, Shodan, theHarvester.</li>
            <li><strong>Сканирование:</strong> Nmap, OpenVAS, Nessus.</li>
            <li><strong>Веб-анализ:</strong> Burp Suite, OWASP ZAP, Nikto.</li>
            <li><strong>Эксплуатация:</strong> Metasploit, Cobalt Strike, SQLmap.</li>
            <li><strong>Сети:</strong> Wireshark, Aircrack-ng, Kismet.</li>
            <li><strong>Пароли:</strong> Hashcat, John the Ripper, Hydra.</li>
            <li><strong>Пост-эксплуатация:</strong> Mimikatz, PowerSploit.</li>
          </ul>
  
          <h2>Схемы этапов пентестинга</h2>
          <p>Ниже представлены схемы для трёх ключевых фаз: разведка, проведение атак и защита. Они показывают последовательность действий и их взаимосвязь:</p>
          <div class="scheme-frame" style="border: 2px solid #000; border-radius: 8px; background-color: #05060a; padding: 20px; display: flex; justify-content: flex-start; align-items: stretch; gap: 40px; position: relative; overflow-x: auto; white-space: nowrap;">
            <div class="pentesting-diagram" style="flex: 0 0 auto; min-width: 250px; padding: 20px; border-radius: 8px; text-align: center; background-color: #05060a;">
              <h3>Разведка</h3>
              <div style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
                <div style="background-color: #2e7d32; padding: 10px; border-radius: 5px; width: 200px; white-space: normal; word-wrap: break-word;">
                  Планирование
                  <p style="font-size: 12px; margin: 5px 0 0; color: #fff;">Определение целей, объема, RoE.</p>
                </div>
                <div style="background-color: #388e3c; padding: 10px; border-radius: 5px; width: 200px; white-space: normal; word-wrap: break-word;">
                  OSINT
                  <p style="font-size: 12px; margin: 5px 0 0; color: #fff;">Сбор данных: Shodan, Maltego, WHOIS.</p>
                </div>
                <div style="border: 2px solid #66bb6a; padding: 10px; border-radius: 5px; width: 250px;">
                  <div id="recon-scan" style="background-color: #66bb6a; padding: 5px; border-radius: 5px; white-space: normal; word-wrap: break-word;">
                    Сканирование сети
                    <p style="font-size: 12px; margin: 5px 0 0; color: #fff;">Nmap, Nessus: поиск хостов, портов.</p>
                  </div>
                  <div style="background-color: #81c784; padding: 5px; border-radius: 5px; margin-top: 5px; white-space: normal; word-wrap: break-word;">
                    Анализ сервисов
                    <p style="font-size: 12px; margin: 5px 0 0; color: #fff;">Определение версий ПО, уязвимостей.</p>
                  </div>
                </div>
                <div style="background-color: #388e3c; padding: 10px; border-radius: 5px; width: 200px; white-space: normal; word-wrap: break-word;">
                  Социальная инженерия
                  <p style="font-size: 12px; margin: 5px 0 0; color: #fff;">Фишинг, сбор данных о сотрудниках.</p>
                </div>
                <div style="background-color: #2a2f3b; padding: 10px; border-radius: 5px; margin-top: 10px; white-space: normal; word-wrap: break-word;">
                  <span style="font-size: 16px;">Результат</span>
                  <p style="font-size: 12px; margin: 5px 0 0; color: #fff;">Карта сети, точки входа, данные для атаки.</p>
                </div>
              </div>
            </div>
  
            <div class="pentesting-diagram" style="flex: 0 0 auto; min-width: 250px; padding: 20px; border-radius: 8px; text-align: center; background-color: #05060a;">
              <h3>Проведение атак</h3>
              <div style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
                <div id="attack-vuln" style="background-color: #2e7d32; padding: 10px; border-radius: 5px; width: 200px; white-space: normal; word-wrap: break-word;">
                  Поиск уязвимостей
                  <p style="font-size: 12px; margin: 5px 0 0; color: #fff;">Burp Suite, OWASP ZAP, Nikto.</p>
                </div>
                <div style="background-color: #388e3c; padding: 10px; border-radius: 5px; width: 200px; white-space: normal; word-wrap: break-word;">
                  Тестирование паролей
                  <p style="font-size: 12px; margin: 5px 0 0; color: #fff;">Hydra, Hashcat: brute force, словарные атаки.</p>
                </div>
                <div style="border: 2px solid #66bb6a; padding: 10px; border-radius: 5px; width: 250px;">
                  <div style="background-color: #66bb6a; padding: 5px; border-radius: 5px; white-space: normal; word-wrap: break-word;">
                    Эксплуатация
                    <p style="font-size: 12px; margin: 5px 0 0; color: #fff;">Metasploit, SQLmap: внедрение эксплойтов.</p>
                  </div>
                  <div style="background-color: #81c784; padding: 5px; border-radius: 5px; margin-top: 5px; white-space: normal; word-wrap: break-word;">
                    Сетевые атаки
                    <p style="font-size: 12px; margin: 5px 0 0; color: #fff;">ARP-спуфинг, MITM через Ettercap.</p>
                  </div>
                </div>
                <div id="attack-escalate" style="background-color: #388e3c; padding: 10px; border-radius: 5px; width: 200px; white-space: normal; word-wrap: break-word;">
                  Эскалация привилегий
                  <p style="font-size: 12px; margin: 5px 0 0; color: #fff;">Mimikatz, Dirty COW: получение root-доступа.</p>
                </div>
                <div style="background-color: #2e7d32; padding: 10px; border-radius: 5px; width: 200px; white-space: normal; word-wrap: break-word;">
                  Пост-эксплуатация
                  <p style="font-size: 12px; margin: 5px 0 0; color: #fff;">Сбор данных, установка бэкдоров.</p>
                </div>
                <div style="background-color: #2a2f3b; padding: 10px; border-radius: 5px; margin-top: 10px; white-space: normal; word-wrap: break-word;">
                  <span style="font-size: 16px;">Результат</span>
                  <p style="font-size: 12px; margin: 5px 0 0; color: #fff;">Доступ к системе, оценка ущерба.</p>
                </div>
              </div>
            </div>
  
            <div class="pentesting-diagram" style="flex: 0 0 auto; min-width: 250px; padding: 20px; border-radius: 8px; text-align: center; background-color: #05060a;">
              <h3>Защита</h3>
              <div style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
                <div id="defense-report" style="background-color: #2e7d32; padding: 10px; border-radius: 5px; width: 200px; white-space: normal; word-wrap: break-word;">
                  Составление отчета
                  <p style="font-size: 12px; margin: 5px 0 0; color: #fff;">Описание уязвимостей, PoC, риски.</p>
                </div>
                <div style="background-color: #388e3c; padding: 10px; border-radius: 5px; width: 200px; white-space: normal; word-wrap: break-word;">
                  Рекомендации
                  <p style="font-size: 12px; margin: 5px 0 0; color: #fff;">Патчи, настройка WAF, 2FA.</p>
                </div>
                <div style="border: 2px solid #66bb6a; padding: 10px; border-radius: 5px; width: 250px;">
                  <div style="background-color: #66bb6a; padding: 5px; border-radius: 5px; white-space: normal; word-wrap: break-word;">
                    Исправление
                    <p style="font-size: 12px; margin: 5px 0 0; color: #fff;">Обновление ПО, закрытие портов.</p>
                  </div>
                  <div style="background-color: #81c784; padding: 5px; border-radius: 5px; margin-top: 5px; white-space: normal; word-wrap: break-word;">
                    Мониторинг
                    <p style="font-size: 12px; margin: 5px 0 0; color: #fff;">SIEM, IDS/IPS для обнаружения атак.</p>
                  </div>
                </div>
                <div style="background-color: #388e3c; padding: 10px; border-radius: 5px; width: 200px; white-space: normal; word-wrap: break-word;">
                  Повторное тестирование
                  <p style="font-size: 12px; margin: 5px 0 0; color: #fff;">Проверка устранения уязвимостей.</p>
                </div>
                <div style="background-color: #2a2f3b; padding: 10px; border-radius: 5px; margin-top: 10px; white-space: normal; word-wrap: break-word;">
                  <span style="font-size: 16px;">Результат</span>
                  <p style="font-size: 12px; margin: 5px 0 0; color: #fff;">Повышение уровня безопасности.</p>
                </div>
              </div>
            </div>
  
            <svg id="arrows-svg" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;">
              <defs>
                <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                  <polygon points="0 0, 10 3.5, 0 7" fill="#666" />
                </marker>
              </defs>
              <path id="arrow1" stroke="#666" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
              <path id="arrow2" stroke="#666" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
            </svg>
          </div>
          <p>Схемы показывают, как данные разведки используются для поиска уязвимостей в фазе атак, а результаты атак формируют отчет для защиты.</p>
  
          <h2>Примеры уязвимостей</h2>
          <ul>
            <li><strong>SQL-инъекция:</strong> Внедрение кода через веб-формы (например, ' OR 1=1 --).</li>
            <li><strong>XSS:</strong> Выполнение скриптов в браузере пользователя.</li>
            <li><strong>Слабые пароли:</strong> Перебор (brute force) или угадывание.</li>
            <li><strong>Misconfiguration:</strong> Открытые порты (3389 RDP), устаревшее ПО.</li>
            <li><strong>Privilege Escalation:</strong> Использование уязвимостей ядра (Dirty COW).</li>
          </ul>
  
          <h2>Проблемы и вызовы</h2>
          <ul>
            <li><strong>Юридические ограничения:</strong> Необходимость соблюдения законов (нельзя нарушать системы без разрешения).</li>
            <li><strong>Сложность систем:</strong> Современные архитектуры (микросервисы, облака) усложняют анализ.</li>
            <li><strong>Ложные срабатывания:</strong> Инструменты могут ошибочно классифицировать уязвимости.</li>
            <li><strong>Этика:</strong> Баланс между тестированием и сохранением работоспособности системы.</li>
          </ul>
  
          <h2>Рекомендации</h2>
          <ul>
            <li>Используйте виртуальные среды для тестирования эксплойтов.</li>
            <li>Комбинируйте автоматизацию (Nmap, Nessus) с ручным анализом.</li>
            <li>Согласуйте RoE (Rules of Engagement) с заказчиком до начала.</li>
            <li>Обновляйте инструменты и базы эксплойтов регулярно.</li>
          </ul>
        </div>
      </div>
    `;
    contentArea.innerHTML = initialContent;

    function drawArrows() {
      const schemeFrame = document.querySelector('.scheme-frame');
      if (!schemeFrame) {
        console.warn('Scheme frame not found.');
        return;
      }

      const reconScan = document.getElementById('recon-scan');
      const attackVuln = document.getElementById('attack-vuln');
      const attackEscalate = document.getElementById('attack-escalate');
      const defenseReport = document.getElementById('defense-report');
  
      if (!reconScan || !attackVuln || !attackEscalate || !defenseReport) {
        console.warn('One or more elements for arrows not found.');
        return;
      }

      const frameRect = schemeFrame.getBoundingClientRect();
      const reconRect = reconScan.getBoundingClientRect();
      const vulnRect = attackVuln.getBoundingClientRect();
      const escalateRect = attackEscalate.getBoundingClientRect();
      const reportRect = defenseReport.getBoundingClientRect();

      const startX1 = reconRect.right - frameRect.left;
      const startY1 = (reconRect.top + reconRect.bottom) / 2 - frameRect.top;
      const endX1 = vulnRect.left - frameRect.left;
      const endY1 = (vulnRect.top + vulnRect.bottom) / 2 - frameRect.top;
  
      const startX2 = escalateRect.right - frameRect.left;
      const startY2 = (escalateRect.top + escalateRect.bottom) / 2 - frameRect.top;
      const endX2 = reportRect.left - frameRect.left;
      const endY2 = (reportRect.top + reportRect.bottom) / 2 - frameRect.top;

      const arrow1 = document.getElementById('arrow1');
      const controlX1 = startX1 + (endX1 - startX1) / 2;
      const controlY1 = startY1;
      const controlX2 = controlX1;
      const controlY2 = endY1;
      arrow1.setAttribute('d', `M${startX1},${startY1} C${controlX1},${controlY1} ${controlX2},${controlY2} ${endX1},${endY1}`);

      const arrow2 = document.getElementById('arrow2');
      const controlX3 = startX2 + (endX2 - startX2) / 2;
      const controlY3 = startY2;
      const controlX4 = controlX3;
      const controlY4 = endY2;
      arrow2.setAttribute('d', `M${startX2},${startY2} C${controlX3},${controlY3} ${controlX4},${controlY4} ${endX2},${endY2}`);
    }

    function debounce(func, wait) {
      let timeout;
      return function (...args) {
        clearTimeout(timeout);
        timeout = setTimeout(() => func.apply(this, args), wait);
      };
    }

    const debouncedDrawArrows = debounce(drawArrows, 100);

    setTimeout(drawArrows, 100);

    window.addEventListener('resize', debouncedDrawArrows);

    document.querySelector('.scheme-frame').addEventListener('scroll', debouncedDrawArrows);
  }